(()=>{"use strict";var e={};e.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),(()=>{var t;e.g.importScripts&&(t=e.g.location+"");var n=e.g.document;if(!t&&n&&(n.currentScript&&"SCRIPT"===n.currentScript.tagName.toUpperCase()&&(t=n.currentScript.src),!t)){var r=n.getElementsByTagName("script");if(r.length)for(var o=r.length-1;o>-1&&(!t||!/^http(s?):/.test(t));)t=r[o--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),e.p=t})();const t=e.p+"images/logo.fc3e6875d825f899a98d.svg";function n(e,t,n,r,o){var a=document.querySelector("#card-template").content.cloneNode(!0).querySelector(".card"),c=a.querySelector(".card__image"),i=a.querySelector(".card__title"),u=a.querySelector(".card__delete-button"),l=a.querySelector(".card__like-button"),s=a.querySelector(".card__like-count");c.src=e.link,c.alt=e.name,i.textContent=e.name,s&&e.likes&&(s.textContent=e.likes.length);var d=e.likes&&e.likes.some(function(e){return e._id===t});return d?l.classList.add("card__like-button_is-active"):l.classList.remove("card__like-button_is-active"),u&&(e.owner&&e.owner._id===t?(u.style.display="block",u.addEventListener("click",function(){n(e._id,a)})):u.style.display="none"),c.addEventListener("click",function(){o(e)}),l.addEventListener("click",function(){r(e._id,l,s,d)}),a}function r(e){e.classList.add("popup_is-opened"),document.addEventListener("keydown",a)}function o(e){e.classList.remove("popup_is-opened"),document.removeEventListener("keydown",a)}function a(e){if("Escape"===e.key){var t=document.querySelector(".popup_is-opened");t&&o(t)}}function c(e){var t=document.querySelector(".popup_type_image"),n=t.querySelector(".popup__image"),o=t.querySelector(".popup__caption");n.src=e.link,n.alt=e.name,o.textContent=e.name,r(t)}function i(e){var t=e.querySelector(".popup__close");t&&t.addEventListener("click",function(){o(e)}),e.addEventListener("click",function(t){t.target===e&&o(e)})}document.addEventListener("DOMContentLoaded",function(){var e=document.querySelector(".header__logo");e&&(e.src=t)});var u=/^[a-zA-Zа-яА-ЯёЁ\s-,]+$/;function l(e,t,n,r){e&&t&&(e.textContent=n,e.classList.add(r.errorClass),t.classList.add(r.inputErrorClass))}function s(e,t,n){e&&t&&(e.textContent="",e.classList.remove(n.errorClass),t.classList.remove(n.inputErrorClass))}function d(e,t){var n=e.querySelectorAll(t.inputSelector),r=e.querySelectorAll(".".concat(t.errorClass)),o=e.querySelector(t.submitButtonSelector);n.forEach(function(e){e.classList.remove(t.inputErrorClass)}),r.forEach(function(e){e.textContent="",e.classList.remove(t.errorClass)}),o&&(o.disabled=!0,t.inactiveButtonClass&&o.classList.add(t.inactiveButtonClass))}function p(e){Array.from(document.querySelectorAll(e.formSelector)).forEach(function(t){!function(e,t){var n={"edit-profile":[{inputSelector:'input[name="name"]',errorSelector:".popup__error_type_name",type:"text",minLength:2,maxLength:40},{inputSelector:'input[name="description"]',errorSelector:".popup__error_type_description",type:"text",minLength:2,maxLength:200}],"new-place":[{inputSelector:'input[name="place-name"]',errorSelector:".popup__error_type_card-name",type:"text",minLength:2,maxLength:30},{inputSelector:'input[name="link"]',errorSelector:".popup__error_type_url",type:"url"}],"edit-avatar":[{inputSelector:'input[name="avatar"]',errorSelector:".popup__error_type_avatar-url",type:"url"}]}[e.getAttribute("name")];n&&function(e,t,n){var r=e.querySelector(t.submitButtonSelector);if(r){var o=n.map(function(a){var c,i=e.querySelector(a.inputSelector),d=e.querySelector(a.errorSelector);return i&&d?(c="url"===a.type?function(e){return function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=e.value.trim(),a=e.dataset.errorMessage||"Вы пропустили это поле.",c=e.dataset.urlError||"Введите адрес сайта.";return 0===o.length?(r?l(t,e,a,n):s(t,e,n),!1):e.validity.valid?(s(t,e,n),!0):(l(t,e,c,n),!1)}(i,d,t,e)}:function(e){return function(e,t,n,r,o){var a=arguments.length>5&&void 0!==arguments[5]&&arguments[5],c=e.value.trim(),i=e.dataset.errorMessage||"Вы пропустили это поле.",d=e.dataset.patternError||"Разрешены только латинские, кириллические буквы, знаки дефиса и пробелы";return 0===c.length?(a?l(t,e,i,n):s(t,e,n),!1):c.length<r||c.length>o?(l(t,e,e.dataset.lengthError||"Должно быть от ".concat(r," до ").concat(o," символов"),n),!1):u.test(c)?(s(t,e,n),!0):(l(t,e,d,n),!1)}(i,d,t,a.minLength,a.maxLength,e)},i.addEventListener("input",function(){var e=c(!0),i=o.filter(function(e,t){return e&&t!==n.indexOf(a)}).map(function(e){return e(!1)}),u=e&&i.every(function(e){return e});r.disabled=!u,t.inactiveButtonClass&&(u?r.classList.remove(t.inactiveButtonClass):r.classList.add(t.inactiveButtonClass))}),i.addEventListener("blur",function(){var e=c(!0),i=o.filter(function(e,t){return e&&t!==n.indexOf(a)}).map(function(e){return e(!1)}),u=e&&i.every(function(e){return e});r.disabled=!u,t.inactiveButtonClass&&(u?r.classList.remove(t.inactiveButtonClass):r.classList.add(t.inactiveButtonClass))}),c):null}).filter(function(e){return null!==e});e._validators=o,e._validationConfig=t}}(e,t,n)}(t,e)})}function f(e){return!(!e._validators||!e._validationConfig)&&function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=e.querySelector(t.submitButtonSelector);if(!o)return!1;var a=!0;return n.forEach(function(e){e(r)||(a=!1)}),o.disabled=!a,t.inactiveButtonClass&&(a?o.classList.remove(t.inactiveButtonClass):o.classList.add(t.inactiveButtonClass)),a}(e,e._validationConfig,e._validators,!0)}var m={baseUrl:"https://nomoreparties.co/v1/".concat("higher-front-back-dev"),headers:{authorization:"483a3b1b-c5d9-4bf7-9a91-8ca9e54e8e28","Content-Type":"application/json"}};function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var _={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"};document.addEventListener("DOMContentLoaded",function(){var e=document.querySelector(".profile__edit-button"),t=document.querySelector(".profile__add-button"),a=document.querySelector(".profile__image-edit-button"),u=document.querySelector(".popup_type_edit"),l=document.querySelector(".popup_type_new-card"),s=document.querySelector(".popup_type_image"),y=document.querySelector(".popup_type_delete-card"),h=document.querySelector(".popup_type_edit-avatar"),b=document.querySelector('form[name="edit-profile"]'),S=document.querySelector('form[name="new-place"]'),g=document.querySelector('form[name="edit-avatar"]'),C=document.querySelector(".profile__title"),L=document.querySelector(".profile__description"),k=document.querySelector(".profile__image"),E=document.querySelector(".places__list"),q=null,x=null,j=null;function B(e,t){x=e,j=t,r(y)}function w(e,t,n,r){var o=r?function(e){return fetch("".concat(m.baseUrl,"/cards/likes/").concat(e),{method:"DELETE",headers:m.headers}).then(function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})}(e):function(e){return fetch("".concat(m.baseUrl,"/cards/likes/").concat(e),{method:"PUT",headers:m.headers}).then(function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})}(e);o.then(function(e){e.likes.some(function(e){return e._id===q})?t.classList.add("card__like-button_is-active"):t.classList.remove("card__like-button_is-active"),n&&e.likes&&(n.textContent=e.likes.length)}).catch(function(e){console.log(e)})}p(_),e.addEventListener("click",function(){var e=b.elements.name,t=b.elements.description;e.value=C.textContent,t.value=L.textContent,d(b,_),b._validators&&b._validators.forEach(function(e){e(!1)}),r(u)}),t.addEventListener("click",function(){d(S,_),r(l)}),a.addEventListener("click",function(){d(g,_),r(h)}),b.addEventListener("submit",function(e){if(e.preventDefault(),f(b)){var t=b.querySelector(_.submitButtonSelector),n=t.textContent,r=b.elements.name,a=b.elements.description,c=r.value.trim(),i=a.value.trim();t.textContent="Сохранение...",t.disabled=!0,function(e,t){return fetch("".concat(m.baseUrl,"/users/me"),{method:"PATCH",headers:m.headers,body:JSON.stringify({name:e,about:t})}).then(function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})}(c,i).then(function(e){C.textContent=e.name,L.textContent=e.about,o(u)}).catch(function(e){console.log(e)}).finally(function(){t.textContent=n,t.disabled=!1})}}),S.addEventListener("submit",function(e){if(e.preventDefault(),f(S)){var t=S.querySelector(_.submitButtonSelector),r=t.textContent,a=S.elements["place-name"],i=S.elements.link,u=a.value.trim(),s=i.value.trim();t.textContent="Сохранение...",t.disabled=!0,function(e,t){return fetch("".concat(m.baseUrl,"/cards"),{method:"POST",headers:m.headers,body:JSON.stringify({name:e,link:t})}).then(function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})}(u,s).then(function(e){var t=n(e,q,B,w,c);E.prepend(t),S.reset(),d(S,_),o(l)}).catch(function(e){console.log(e)}).finally(function(){t.textContent=r,t.disabled=!1})}}),g.addEventListener("submit",function(e){if(e.preventDefault(),f(g)){var t=g.querySelector(_.submitButtonSelector),n=t.textContent,r=g.elements.avatar.value.trim();t.textContent="Сохранение...",t.disabled=!0,function(e){return fetch("".concat(m.baseUrl,"/users/me/avatar"),{method:"PATCH",headers:m.headers,body:JSON.stringify({avatar:e})}).then(function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})}(r).then(function(e){k.style.backgroundImage="url('".concat(e.avatar,"')"),o(h)}).catch(function(e){console.log(e)}).finally(function(){t.textContent=n,t.disabled=!1})}});var A=y.querySelector(".popup__button_type_confirm");A.addEventListener("click",function(){if(x){var e=A.textContent;A.textContent="Удаление...",A.disabled=!0,(t=x,fetch("".concat(m.baseUrl,"/cards/").concat(t),{method:"DELETE",headers:m.headers}).then(function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).then(function(){j&&j.remove(),o(y),x=null,j=null}).catch(function(e){console.log(e)}).finally(function(){A.textContent=e,A.disabled=!1})}var t}),i(u),i(l),i(s),i(y),i(h),Promise.all([fetch("".concat(m.baseUrl,"/users/me"),{headers:m.headers}).then(function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}),fetch("".concat(m.baseUrl,"/cards"),{headers:m.headers}).then(function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})]).then(function(e){var t,r,o=(r=2,function(e){if(Array.isArray(e))return e}(t=e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,c,i=[],u=!0,l=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=a.call(n)).done)&&(i.push(r.value),i.length!==t);u=!0);}catch(e){l=!0,o=e}finally{try{if(!u&&null!=n.return&&(c=n.return(),Object(c)!==c))return}finally{if(l)throw o}}return i}}(t,r)||function(e,t){if(e){if("string"==typeof e)return v(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?v(e,t):void 0}}(t,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),a=o[0],i=o[1];q=a._id,C.textContent=a.name,L.textContent=a.about,k.style.backgroundImage="url('".concat(a.avatar,"')"),function(e,t){e.forEach(function(e){var r=n(e,t,B,w,c);E.appendChild(r)})}(i,a._id)}).catch(function(e){console.log(e)})})})();